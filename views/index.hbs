<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />


  <title>Document</title>
</head>

<body>
  <h1>Check what's going on around you!</h1>
  <div class="row justify-content-around px-5 mx-4">
    {{#each eventItems}}
    <div class="card mt-3 mx-2 col-lg-3 col-md-5 shadow ">
      <img class="card-img-top" style="object-fit: cover;" src="{{images.0.url}}" alt="">
      <div class="card-body spot-color">
        <h5 class="card-title mb-1">{{this.name}}</h5>
        <p class="card-text mb-0 pb-0">{{this.readableDate}} at {{this.readableTime}}</p>
        <p class="text-secondary font-italic pt-0 my-0">Organised by {{this.organizer.name}}</p>
        <div class="text-center">
        <a href="/events/{{id}}" class="btn text-center align-text-bottom btn-outline-success mt-3">Discover more</a>
        </div>
      </div>
    </div>
    {{/each}}
  </div>




  <p class="d-none">
    latitude: <span id="latitude"></span>&deg;<br />
    longitude: <span id="longitude"></span>&deg;
  </p>
  <div id="mymap"></div>

  {{!-------------------------------------------MAPA-------------------------------------------}}
  <script>
    const latInput = document.getElementById("lat")
    const lonInput = document.getElementById("lon")
    const mymap = L.map("mymap", {
      marker = L.marker([lat, lon]).addTo(mymap);
      minZoom: 14,
    })
    let marker
    if ("geolocation" in navigator) {
      console.log("geolocation available");
      navigator.geolocation.getCurrentPosition(position => {
        lat = position.coords.latitude;
        lon = position.coords.longitude;
        console.log(lat, lon);
        document.getElementById("latitude").textContent = lat;
        document.getElementById("longitude").textContent = lon;
        mymap.setView([lat, lon], 20);
        const attribution = '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> ';
        const tileUrl = "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png";
        const tiles = L.tileLayer(tileUrl, { attribution });
        tiles.addTo(mymap);
        marker = L.marker([lat, lon]).addTo(mymap);
        latInput.value = lat
        lonInput.value = lon
      })
    } else {
      console.log("geolocation not available")
    }

  </script>
  {{!-------------------------------------------MAPA-------------------------------------------}}

</body>

</html>